# Archive Log Management
[docs.oracle.com](https://docs.oracle.com/cd/B28359_01/server.111/b28294/log_arch_dest_param.htm#i91817) \
[docs.oracle.com](https://docs.oracle.com/cd/B19306_01/server.102/b14239/log_arch_dest_param.htm#CACDFDBH)

- In the following, a list of parameters is presented that can be used to configure Archive Logs:

-------------------------------------------------------------------------------
- List of all Archive_Destinations:
```
SQL> select dest_id,dest_name,status,type,database_mode,recovery_mode,destination from v$archive_dest_status;
DEST_ID DEST_NAME           STATUS    TYPE      DATABASE_MODE   RECOVERY_MODE            DESTINATION      
------- ------------------- --------- --------- --------------- ------------------------ -----------------
1       LOG_ARCHIVE_DEST_1  VALID     LOCAL     OPEN            IDLE                     +DATA/arc        
2       LOG_ARCHIVE_DEST_2  VALID     LOGICAL   OPEN            LOGICAL REAL TIME APPLY  shdb             
3       LOG_ARCHIVE_DEST_3  VALID     PHYSICAL  OPEN_READ-ONLY  MANAGED REAL TIME APPLY  shdg             
4       LOG_ARCHIVE_DEST_4  VALID     LOCAL     OPEN            IDLE                     +DATA/arc/stdarc 
5       LOG_ARCHIVE_DEST_5  INACTIVE  LOCAL     UNKNOWN         IDLE                     
6       LOG_ARCHIVE_DEST_6  INACTIVE  LOCAL     UNKNOWN         IDLE                     
7       LOG_ARCHIVE_DEST_7  INACTIVE  LOCAL     UNKNOWN         IDLE                     
...
```
-------------------------------------------------------------------------------
- **MANDATORY**: 
Specifies that filled online log files must be successfully archived 
	to the destination before they can be reused. 


> The LOG_ARCHIVE_MIN_SUCCEED_DEST=n parameter (where n is an integer from 1 to 10) 
  specifies the number of destinations that must archive successfully before 
  online redo log files can be overwritten.
  All MANDATORY destinations and optional local destinations contribute to satisfy 
  the LOG_ARCHIVE_MIN_SUCCEED_DEST=n count. 

> The "LOG_ARCHIVE_MIN_SUCCEED_DEST" parameter value CANNOT be greater than the number 
  of "mandatory destinations" + "optional local destinations".

-------------------------------------------------------------------------------
- **ALTERNATE**:
Specifies an alternate archiving destination to be used when the 
	original destination fails. 

> You can specify only one alternate destination for each LOG_ARCHIVE_DEST_n parameter.

> Any destination can be designated as an alternate destination, given the following restrictions:  \
	1- At least one "local" mandatory destination is "Enabled". \
	2- The number of enabled destinations must meet the defined "LOG_ARCHIVE_MIN_SUCCEED_DEST" parameter value. \
	3- A destination cannot be its own alternate. 

- Example 1 (Alternate Destination to the alternative disk):
```
LOG_ARCHIVE_DEST_1='LOCATION=/disk1 MANDATORY ALTERNATE=LOG_ARCHIVE_DEST_2'
	LOG_ARCHIVE_DEST_STATE_1=ENABLE
	LOG_ARCHIVE_DEST_2='LOCATION=/disk2 MANDATORY'
	LOG_ARCHIVE_DEST_STATE_2=ALTERNATE
```
- Example 2 (Alternate Oracle Net Service Name to the Same Standby Database):
```
LOG_ARCHIVE_DEST_1='LOCATION=/disk1 MANDATORY'
	LOG_ARCHIVE_DEST_STATE_1=ENABLE
	LOG_ARCHIVE_DEST_2='SERVICE=stby1_path1 ALTERNATE=LOG_ARCHIVE_DEST_3'
	LOG_ARCHIVE_DEST_STATE_2=ENABLE
	LOG_ARCHIVE_DEST_3='SERVICE=stby1_path2'
	LOG_ARCHIVE_DEST_STATE_3=ALTERNATE
```

-------------------------------------------------------------------------------

- **SYNC** and **ASYNC**: \
Specifies whether the synchronous (SYNC) or asynchronous (ASYNC) 
	redo transport mode is to be used. 

> SYNC: \
	The redo data generated by a transaction must have been received by every enabled 
	destination that has the "SYNC" attribute before that transaction can "commit". \
> ASYNC: \
	The redo data generated by a transaction need NOT have been received at a 
	destination that has the ASYNC attribute before that transaction can commit. 
	This is the "default" behavior if neither SYNC or ASYNC is specified.

-------------------------------------------------------------------------------

- **VALID_FOR**: [Default: VALID_FOR=(ALL_LOGFILES,ALL_ROLES)] \
Specifies whether redo data will be written to a destination,
	based on the following factors: 
	
> **Database Role**:  Whether the database is currently running in the "primary" or the "standby" role. \
		PRIMARY_ROLE	—> This destination is valid only when the database is running in the "primary" role. \
		STANDBY_ROLE	—> This destination is valid only when the database is running in the "standby" role. \
		ALL_ROLES	—> This destination is valid when the database is running in either the "primary" or the "standby" role. 

> **Redo Log Type**: 	  Whether "online redo log files", "standby redo log files", or "both" are \
		currently being archived on the database at this destination. \
		ONLINE_LOGFILE	—> This destination is valid only when archiving "online redo log files". \
		STANDBY_LOGFILE	—> This destination is valid only when archiving "standby redo log files". \
		ALL_LOGFILES	—> This destination is valid when archiving either "online redo log files" or "standby redo log files". \

-------------------------------------------------------------------------------

- **ARCH** and **LGWR**: [Default: ARCH] \
	Specifies whether redo transport services use archiver processes (ARCn) or 
	the log writer process (LGWR) to collect transaction redo data and transmit 
	it to standby destinations. 
 

- Example:
```
LOG_ARCHIVE_DEST_3='SERVICE=denver LGWR'
	LOG_ARCHIVE_DEST_STATE_3=ENABLE
```

-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

- This is a Sample Configuration for an **Active Data Guard**:
```
SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_1='LOCATION=+FRA VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=orcldb' scope=both;
SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_1=ENABLE scope=both;
SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=DBSTBY LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=stand' scope=both;
SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_STATE_2=ENABLE scope=both;
```

-------------------------------------------------------------------------------



